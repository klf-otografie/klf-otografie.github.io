<div class="inner-content">
    <div class="portfolio-container">
        <!-- Gallery 1 -->
        <div class="gallery-block" id="gallery1-block">
            <h2>Gallery 1</h2>
            <div class="gallery-row">
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_001/gallery_001_image_001.webp" alt="Gallery 1 image 1" onclick="openModalPortfolioGallery('gallery1', 0)">
                </div>
            </div>
        </div>

        <!-- Gallery 2 -->
        <div class="gallery-block" id="gallery2-block">
            <h2>Gallery 2</h2>
            <div class="gallery-row thumbnails">
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_002/gallery_002_image_001.webp" alt="Gallery 2 image 1" onclick="openModalPortfolioGallery('gallery2', 0)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_002/gallery_002_image_002.webp" alt="Gallery 2 image 2" onclick="openModalPortfolioGallery('gallery2', 1)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_002/gallery_002_image_003.webp" alt="Gallery 2 image 3" onclick="openModalPortfolioGallery('gallery2', 2)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_002/gallery_002_image_004.webp" alt="Gallery 2 image 4" onclick="openModalPortfolioGallery('gallery2', 3)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_002/gallery_002_image_005.webp" alt="Gallery 2 image 5" onclick="openModalPortfolioGallery('gallery2', 4)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_002/gallery_002_image_006.webp" alt="Gallery 2 image 6" onclick="openModalPortfolioGallery('gallery2', 5)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_002/gallery_002_image_007.webp" alt="Gallery 2 image 7" onclick="openModalPortfolioGallery('gallery2', 6)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_002/gallery_002_image_008.webp" alt="Gallery 2 image 8" onclick="openModalPortfolioGallery('gallery2', 7)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_002/gallery_002_image_009.webp" alt="Gallery 2 image 9" onclick="openModalPortfolioGallery('gallery2', 8)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_002/gallery_002_image_010.webp" alt="Gallery 2 image 10" onclick="openModalPortfolioGallery('gallery2', 9)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_002/gallery_002_image_011.webp" alt="Gallery 2 image 11" onclick="openModalPortfolioGallery('gallery2', 10)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_002/gallery_002_image_012.webp" alt="Gallery 2 image 12" onclick="openModalPortfolioGallery('gallery2', 11)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_002/gallery_002_image_013.webp" alt="Gallery 2 image 13" onclick="openModalPortfolioGallery('gallery2', 12)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_002/gallery_002_image_014.webp" alt="Gallery 2 image 14" onclick="openModalPortfolioGallery('gallery2', 13)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_002/gallery_002_image_015.webp" alt="Gallery 2 image 15" onclick="openModalPortfolioGallery('gallery2', 14)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_002/gallery_002_image_016.webp" alt="Gallery 2 image 16" onclick="openModalPortfolioGallery('gallery2', 15)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_002/gallery_002_image_017.webp" alt="Gallery 2 image 17" onclick="openModalPortfolioGallery('gallery2', 16)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_002/gallery_002_image_018.webp" alt="Gallery 2 image 18" onclick="openModalPortfolioGallery('gallery2', 17)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_002/gallery_002_image_019.webp" alt="Gallery 2 image 19" onclick="openModalPortfolioGallery('gallery2', 18)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_002/gallery_002_image_020.webp" alt="Gallery 2 image 20" onclick="openModalPortfolioGallery('gallery2', 19)">
                </div>
            </div>
        </div>

        <!-- Gallery 3 -->
        <div class="gallery-block" id="gallery3-block">
            <h2>Gallery 3</h2>
            <div class="gallery-row">
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_003/gallery_003_image_001.webp" alt="Gallery 3 image 1" onclick="openModalPortfolioGallery('gallery3', 0)">
                </div>
            </div>
        </div>

        <!-- Gallery 4 -->
        <div class="gallery-block" id="gallery4-block">
            <h2>Gallery 4</h2>
            <div class="gallery-row thumbnails">
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_004/gallery_004_image_001.webp" alt="Gallery 4 image 1" onclick="openModalPortfolioGallery('gallery4', 0)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_004/gallery_004_image_002.webp" alt="Gallery 4 image 2" onclick="openModalPortfolioGallery('gallery4', 1)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_004/gallery_004_image_003.webp" alt="Gallery 4 image 3" onclick="openModalPortfolioGallery('gallery4', 2)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_004/gallery_004_image_004.webp" alt="Gallery 4 image 4" onclick="openModalPortfolioGallery('gallery4', 3)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_004/gallery_004_image_005.webp" alt="Gallery 4 image 5" onclick="openModalPortfolioGallery('gallery4', 4)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_004/gallery_004_image_006.webp" alt="Gallery 4 image 6" onclick="openModalPortfolioGallery('gallery4', 5)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_004/gallery_004_image_007.webp" alt="Gallery 4 image 7" onclick="openModalPortfolioGallery('gallery4', 6)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_004/gallery_004_image_008.webp" alt="Gallery 4 image 8" onclick="openModalPortfolioGallery('gallery4', 7)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_004/gallery_004_image_009.webp" alt="Gallery 4 image 9" onclick="openModalPortfolioGallery('gallery4', 8)">
                </div>
            </div>
        </div>

        <!-- Gallery 5 -->
        <div class="gallery-block" id="gallery5-block">
            <h2>Gallery 5</h2>
            <div class="gallery-row thumbnails">
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_005/gallery_005_image_001.webp" alt="Gallery 5 image 1" onclick="openModalPortfolioGallery('gallery5', 0)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_005/gallery_005_image_002.webp" alt="Gallery 5 image 2" onclick="openModalPortfolioGallery('gallery5', 1)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_005/gallery_005_image_003.webp" alt="Gallery 5 image 3" onclick="openModalPortfolioGallery('gallery5', 2)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_005/gallery_005_image_004.webp" alt="Gallery 5 image 4" onclick="openModalPortfolioGallery('gallery5', 3)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_005/gallery_005_image_005.webp" alt="Gallery 5 image 5" onclick="openModalPortfolioGallery('gallery5', 4)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_005/gallery_005_image_006.webp" alt="Gallery 5 image 6" onclick="openModalPortfolioGallery('gallery5', 5)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_005/gallery_005_image_007.webp" alt="Gallery 5 image 7" onclick="openModalPortfolioGallery('gallery5', 6)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_005/gallery_005_image_008.webp" alt="Gallery 5 image 8" onclick="openModalPortfolioGallery('gallery5', 7)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_005/gallery_005_image_009.webp" alt="Gallery 5 image 9" onclick="openModalPortfolioGallery('gallery5', 8)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_005/gallery_005_image_010.webp" alt="Gallery 5 image 10" onclick="openModalPortfolioGallery('gallery5', 9)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_005/gallery_005_image_011.webp" alt="Gallery 5 image 11" onclick="openModalPortfolioGallery('gallery5', 10)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_005/gallery_005_image_012.webp" alt="Gallery 5 image 12" onclick="openModalPortfolioGallery('gallery5', 11)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_005/gallery_005_image_013.webp" alt="Gallery 5 image 13" onclick="openModalPortfolioGallery('gallery5', 12)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_005/gallery_005_image_014.webp" alt="Gallery 5 image 14" onclick="openModalPortfolioGallery('gallery5', 13)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_005/gallery_005_image_015.webp" alt="Gallery 5 image 15" onclick="openModalPortfolioGallery('gallery5', 14)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_005/gallery_005_image_016.webp" alt="Gallery 5 image 16" onclick="openModalPortfolioGallery('gallery5', 15)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_005/gallery_005_image_017.webp" alt="Gallery 5 image 17" onclick="openModalPortfolioGallery('gallery5', 16)">
                </div>
                <div class="gallery-item">
                    <img src="portfolio/assets/gallery_005/gallery_005_image_018.webp" alt="Gallery 5 image 18" onclick="openModalPortfolioGallery('gallery5', 17)">
                </div>
            </div>
        </div>

        <!-- Modal Portfolio Popup -->
        <div id="portfolioModal" class="modal">
            <span class="close-modal" onclick="closePortfolioGallery()">&times;</span>
            <div class="modal-content">
                <div class="gallery-main">
                    <button class="gallery-button prev-button" onclick="changePortfolioSlide(-1)">❮</button>
                    <img id="portfolioMainImage" src="" alt="Portfolio image">
                    <button class="gallery-button next-button" onclick="changePortfolioSlide(1)">❯</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // ------------------------------
    // Portfolio Gallery Layout Code
    // ------------------------------
    
    // Layout a single row of images in the gallery
    function justifyPortfolioGalleryRow(row, containerWidth, targetHeight) {
        if (!row.length || !containerWidth) return;
        
        const totalAspectRatio = row.reduce((sum, img) => {
            return sum + (img.naturalWidth / img.naturalHeight);
        }, 0);
        
        const gapWidth = 5;
        const totalGaps = row.length - 1;
        const availableWidth = containerWidth - (totalGaps * gapWidth);
        
        const rowHeight = availableWidth / totalAspectRatio;
        
        row.forEach(img => {
            const aspectRatio = img.naturalWidth / img.naturalHeight;
            const width = Math.floor(rowHeight * aspectRatio);
            
            const container = img.parentElement;
            container.style.width = `${width}px`;
            container.style.height = `${rowHeight}px`;
        });
    }

    // Initialize the layout for all gallery rows
    function initializePortfolioGalleryLayout() {
        requestAnimationFrame(() => {
            const galleries = document.querySelectorAll('.gallery-row');
            const targetHeight = 250;
            
            galleries.forEach(gallery => {
                const containerWidth = gallery.getBoundingClientRect().width;
                let currentRow = [];
                let currentRowWidth = 0;
                const gapWidth = 5;
                
                const images = Array.from(gallery.querySelectorAll('img'));
                
                images.forEach((img, index) => {
                    if (!img.complete || !img.naturalWidth) return;
                    
                    const aspectRatio = img.naturalWidth / img.naturalHeight;
                    const scaledWidth = targetHeight * aspectRatio;
                    
                    currentRow.push(img);
                    currentRowWidth += scaledWidth + (currentRow.length > 1 ? gapWidth : 0);
                    
                    if (currentRowWidth >= containerWidth || index === images.length - 1) {
                        justifyPortfolioGalleryRow(currentRow, containerWidth, targetHeight);
                        currentRow = [];
                        currentRowWidth = 0;
                    }
                });
                
                if (currentRow.length > 0) {
                    justifyPortfolioGalleryRow(currentRow, containerWidth, targetHeight);
                }
            });
        });
    }

    // Utility function to debounce resize events
    function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
            const later = () => {
                clearTimeout(timeout);
                func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
        };
    }

    // ------------------------------
    // Portfolio Gallery Initialization
    // ------------------------------
    
    // Initialize gallery layout when images are loaded
    const portfolioImages = document.querySelectorAll('.gallery-row img');
    Promise.all(Array.from(portfolioImages).map(img => {
        if (img.complete) return Promise.resolve();
        return new Promise(resolve => {
            img.onload = resolve;
            img.onerror = resolve;
        });
    })).then(() => {
        initializePortfolioGalleryLayout();
    });

    // Add resize handler with debouncing
    const debouncedResize = debounce(() => {
        initializePortfolioGalleryLayout();
    }, 250);

    window.addEventListener('resize', debouncedResize);

    // Handle orientation changes
    window.addEventListener('orientationchange', () => {
        setTimeout(initializePortfolioGalleryLayout, 100);
    });

    // Add this new function to handle modal background clicks
    function handleModalClick(event) {
        if (event.target.id === 'portfolioModal') {
            closePortfolioGallery();
        }
    }

    // Add event listener for escape key
    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
            closePortfolioGallery();
        }
    });
</script>